var deviceManager = require("smartkitchens/entities/devicemanager")
var utils = require("smartkitchens/entities/utils");

var query = {};
if(request.body != null){
	query = request.body;
}else if(request.parameters.body){
	query = request.parameters.body;
} else {
  query = request.parameters;
}
var documents = [];

if(query.id) {
  documents = [deviceManager.getLatestDeviceEntry(query.id)];
} else {
    var devices = deviceManager.getAllDevicesDefinition();
    if(devices) {
        for(var j = 0; j < devices.length; j++) {
            console.log(devices[j].id)
            var entry = deviceManager.getLatestDeviceEntry(devices[j].id)
            if(entry)
                documents.push(entry)
                }
    }
}

return utils.format(documents);

